--- ORDER BY (ASC / DESC)
SELECT * FROM ALUNO ORDER BY NOME ASC;
SELECT * FROM ALUNO ORDER BY NOME DESC;
SELECT * FROM ALUNO ORDER BY SEXO, BAIRRO ASC;

--- EXERCÍCIOS AULA 6:
-- 6-1: SELECT * FROM PROFESSOR WHERE ESPECIALIDADE IN ('Matematica','Literatura') ORDER BY NOME ASC;
-- 6-2: SELECT * FROM FREQUENTA ORDER BY NOTA DESC;
-- 6-3: SELECT DISTINCT ESPECIALIDADE FROM PROFESSOR;

---- GROUP BY e HAVING: Agrupando Dados

DECLARE @i FLOAT = 6.677756

SELECT 
      ROUND(@i, 2)
    , FORMAT(@i, 'N2')
    , CAST(@i AS DECIMAL(18,2))
    , SUBSTRING(PARSENAME(CAST(@i AS VARCHAR(10)), 1), PATINDEX('%.%', CAST(@i AS VARCHAR(10))) - 1, 2)
    , FLOOR((@i - FLOOR(@i)) * 100)
		
-- Usando o Group By, precisamos declarar todas as colunas que estão sendo declaradas, exceto as funções, neste caso o AVG.
		
SELECT CODTURMA, FORMAT(AVG(NOTA),'N2') FROM FREQUENTA GROUP BY CODTURMA --- EM SUBSTITUIÇÃO DE: SELECT CODTURMA, TO_CHAR(AVG(NOTA),'99.9') FROM FREQUENTA GROUP BY CODTURMA

SELECT CODTURMA, SEMESTRE ,FORMAT(AVG(NOTA),'N2') FROM FREQUENTA GROUP BY CODTURMA, SEMESTRE
SELECT BAIRRO, COUNT(DISTINCT SEXO) FROM ALUNO GROUP BY BAIRRO;
SELECT BAIRRO, COUNT(*) FROM ALUNO WHERE BAIRRO IS NOT NULL GROUP BY BAIRRO;
SELECT CIDADE, BAIRRO, COUNT(*) AS 'Total' FROM ALUNO WHERE CIDADE IS NOT NULL GROUP BY CIDADE, BAIRRO ORDER BY 'Total' DESC;

-- HAVING: Serve para impor condições em agrupamentos como se fosse um Where. (Usar depois de Group By)
SELECT CIDADE, BAIRRO, COUNT(*) AS 'Total' FROM ALUNO WHERE CIDADE IS NOT NULL GROUP BY CIDADE, BAIRRO  HAVING BAIRRO LIKE '%Sul' ORDER BY BAIRRO DESC;

-- EXERCÍCIOS DA AULA 8
-- 8-1: SELECT NOMEFACULDADEFORMACAO AS 'Faculdade de Formação', COUNT(NOMEFACULDADEFORMACAO) AS 'Qtde de Professores' FROM PROFESSOR GROUP BY NOMEFACULDADEFORMACAO ORDER BY NOMEFACULDADEFORMACAO ASC;
-- 8-2: SELECT NOMEFACULDADEFORMACAO AS 'Faculdade de Formação', SEXO ,COUNT(NOMEFACULDADEFORMACAO) AS 'Qtde de Professores' FROM PROFESSOR GROUP BY NOMEFACULDADEFORMACAO, SEXO ORDER BY NOMEFACULDADEFORMACAO ASC;
-- 8-3: SELECT especialidade,nomefaculdadeformacao FROM PROFESSOR GROUP BY especialidade, NOMEFACULDADEFORMACAO
